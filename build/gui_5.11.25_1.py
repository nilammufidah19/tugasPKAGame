# This file was generated by the Tkinter Designer by Parth Jadhav
# https://github.com/ParthJadhav/Tkinter-Designer

import random
from pathlib import Path

# from tkinter import *
# Explicit imports to satisfy Flake8
from tkinter import Tk, Canvas, Entry, Text, Button, PhotoImage

OUTPUT_PATH = Path(__file__).parent
ASSETS_PATH = OUTPUT_PATH / Path(r"./assets/frame0")


def relative_to_assets(path: str) -> Path:
    return ASSETS_PATH / Path(path)


root = Tk()

root.title("Kitty Cup")
# root.iconbitmap(r"D:\ML Projects\Mini Game\GUI\gui\assets\hb.ico")
root.geometry("1440x1024")
root.configure(bg="#F2EFED")

canvas = Canvas(
    root,
    bg="#F2EFED",
    height=1024,
    width=1440,
    bd=0,
    highlightthickness=0,
    relief="ridge"
)

canvas.place(x=0, y=0)

############################# MAIN AREA #################################
image_files = [
    ("image_1.png", 561.0, 512.0),  # main_area
    ("image_2.png", 735.0, 685.0),  # tile1
    ("image_3.png", 562.0, 685.0),  # tile2
    ("image_4.png", 387.0, 685.0),  # tile3
    ("image_5.png", 735.0, 511.0),  # tile4
    ("image_6.png", 562.0, 511.0),  # tile5
    ("image_7.png", 387.0, 511.0),  # tile6
    ("image_8.png", 735.0, 338.0),  # tile7
    ("image_9.png", 562.0, 338.0),  # tile8
    ("image_10.png", 387.0, 338.0), # tile9
]

images = []
for idx, (filename, x, y) in enumerate(image_files):
    img = PhotoImage(file=relative_to_assets(filename))
    images.append(img)  # store to prevent garbage collection
    canvas.create_image(
        x,
        y,
        image=img,
        tags=("default_main_area",)
    )

############################# SCORE AREA #################################
total_score = 0

# Fungsi untuk memperbarui tampilan skor
def update_my_score_display():
    her_entry_score.config(state="normal")          # Aktifkan field agar bisa diubah
    her_entry_score.delete(0, "end")                # Hapus nilai lama
    her_entry_score.insert(0, str(total_score))     # Masukkan nilai terbaru
    her_entry_score.config(state="readonly")        # Kunci kembali field

# Gambar latar skor
image_my_score = PhotoImage(file=relative_to_assets("image_11.png"))
canvas.create_image(1055.5, 699.0, image=image_my_score, tags=("score_area"))

image_his_score = PhotoImage(file=relative_to_assets("image_12.png"))
canvas.create_image(1055.0, 599.0, image=image_his_score, tags=("score_area"))

# Entry background untuk skor lawan
entry_bg_his = PhotoImage(file=relative_to_assets("entry_1.png"))
canvas.create_image(1120.0, 599.5, image=entry_bg_his, tags=("score_area"))

his_entry_score = Entry(
    bd=0,
    readonlybackground="#d7def0",
    fg="#004AAD",
    font=("Comic Sans MS", 25, "bold"),
    highlightthickness=0,
    state="readonly"
)
his_entry_score_id = canvas.create_window(1105, 600.0, window=his_entry_score)
canvas.itemconfig(his_entry_score_id, width=50, height=30)

# Entry background untuk skor kita
entry_bg_her = PhotoImage(file=relative_to_assets("entry_2.png"))
canvas.create_image(1105.0, 699.5, image=entry_bg_her, tags=("score_area"))

her_entry_score = Entry(
    bd=0,
    readonlybackground="#fbdfef",
    fg="#F2649E",
    font=("Comic Sans MS", 25, "bold"),
    highlightthickness=0,
    state="normal"
)
her_entry_score_id = canvas.create_window(1090, 700.0, window=her_entry_score)
canvas.itemconfig(her_entry_score_id, width=50, height=30)

# Inisialisasi tampilan skor awal
her_entry_score.insert(0, str(total_score))
her_entry_score.config(state="readonly")

############################# CARD AREA #################################

image_image_13 = PhotoImage(
    file=relative_to_assets("image_13.png"))
mca1 = canvas.create_image(
    388.0,
    892.0,
    image=image_image_13,
    tags=("card_area")
)

mca2 = canvas.create_image(
    727.0,
    892.0,
    image=image_image_13,
    tags=("card_area")
)

mca3 = canvas.create_image(
    558.0,
    892.0,
    image=image_image_13,
    tags=("card_area")
)

hca1 = canvas.create_image(
    388.0,
    142.0,
    image=image_image_13,
    tags=("card_area")
)

hca2 = canvas.create_image(
    558.0,
    142.0,
    image=image_image_13,
    tags=("card_area")
)

hca3 = canvas.create_image(
    728.0,
    142.0,
    image=image_image_13,
    tags=("card_area")
)

image_back_card = PhotoImage(
    file=relative_to_assets("image_68.png"))
hc1 = canvas.create_image(
    388.0,
    142.0,
    image=image_back_card,
    tags=("card_area", "back_card")
)

hc2 = canvas.create_image(
    558.0,
    142.0,
    image=image_back_card,
    tags=("card_area", "back_card")
)

hc3 = canvas.create_image(
    728.0,
    142.0,
    image=image_back_card,
    tags=("card_area", "back_card_last")
)

############################# CARD BUTTON #################################
button_image_31 = PhotoImage(
    file=relative_to_assets("button_31.png"))
kp11 = Button(
    image=button_image_31,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp11)
)
button_data = {"id": "kp11", "warna": "putih", "angka": 1}
# Store all data as attributes
kp11.id = button_data["id"]
kp11.warna = button_data["warna"]
kp11.angka = button_data["angka"]

kp12 = Button(
    image=button_image_31,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp12)
)
button_data = {"id": "kp12", "warna": "putih", "angka": 1}
# Store all data as attributes
kp12.id = button_data["id"]
kp12.warna = button_data["warna"]
kp12.angka = button_data["angka"]

kp13 = Button(
    image=button_image_31,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp13)
)
button_data = {"id": "kp13", "warna": "putih", "angka": 1}
# Store all data as attributes
kp13.id = button_data["id"]
kp13.warna = button_data["warna"]
kp13.angka = button_data["angka"]

button_image_32 = PhotoImage(
    file=relative_to_assets("button_32.png"))
kp21 = Button(
    image=button_image_32,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp21)
)
button_data = {"id": "kp21", "warna": "putih", "angka": 2}
# Store all data as attributes
kp21.id = button_data["id"]
kp21.warna = button_data["warna"]
kp21.angka = button_data["angka"]

kp22 = Button(
    image=button_image_32,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp22)
)
button_data = {"id": "kp22", "warna": "putih", "angka": 2}
# Store all data as attributes
kp22.id = button_data["id"]
kp22.warna = button_data["warna"]
kp22.angka = button_data["angka"]

kp23 = Button(
    image=button_image_32,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp23)
)
button_data = {"id": "kp23", "warna": "putih", "angka": 2}
# Store all data as attributes
kp23.id = button_data["id"]
kp23.warna = button_data["warna"]
kp23.angka = button_data["angka"]

button_image_30 = PhotoImage(
    file=relative_to_assets("button_30.png"))
kp31 = Button(
    image=button_image_30,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp31)
)
button_data = {"id": "kp31", "warna": "putih", "angka": 3}
# Store all data as attributes
kp31.id = button_data["id"]
kp31.warna = button_data["warna"]
kp31.angka = button_data["angka"]

kp32 = Button(
    image=button_image_30,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp31)
)
button_data = {"id": "kp32", "warna": "putih", "angka": 3}
# Store all data as attributes
kp32.id = button_data["id"]
kp32.warna = button_data["warna"]
kp32.angka = button_data["angka"]

kp33 = Button(
    image=button_image_30,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kp31)
)
button_data = {"id": "kp33", "warna": "putih", "angka": 3}
# Store all data as attributes
kp33.id = button_data["id"]
kp33.warna = button_data["warna"]
kp33.angka = button_data["angka"]

button_image_20 = PhotoImage(
    file=relative_to_assets("button_20.png"))
kb11 = Button(
    image=button_image_20,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb11)
)
button_data = {"id": "kb11", "warna": "biru", "angka": 1}
# Store all data as attributes
kb11.id = button_data["id"]
kb11.warna = button_data["warna"]
kb11.angka = button_data["angka"]

kb12 = Button(
    image=button_image_20,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb12)
)
button_data = {"id": "kb12", "warna": "biru", "angka": 1}
# Store all data as attributes
kb12.id = button_data["id"]
kb12.warna = button_data["warna"]
kb12.angka = button_data["angka"]

kb13 = Button(
    image=button_image_20,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb13)
)
button_data = {"id": "kb13", "warna": "biru", "angka": 1}
# Store all data as attributes
kb13.id = button_data["id"]
kb13.warna = button_data["warna"]
kb13.angka = button_data["angka"]

button_image_21 = PhotoImage(
    file=relative_to_assets("button_21.png"))
kb21 = Button(
    image=button_image_21,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb21)
)
button_data = {"id": "kb21", "warna": "biru", "angka": 2}
# Store all data as attributes
kb21.id = button_data["id"]
kb21.warna = button_data["warna"]
kb21.angka = button_data["angka"]

kb22 = Button(
    image=button_image_21,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb22)
)
button_data = {"id": "kb22", "warna": "biru", "angka": 2}
# Store all data as attributes
kb22.id = button_data["id"]
kb22.warna = button_data["warna"]
kb22.angka = button_data["angka"]

kb23 = Button(
    image=button_image_21,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb23)
)
button_data = {"id": "kb23", "warna": "biru", "angka": 2}
# Store all data as attributes
kb23.id = button_data["id"]
kb23.warna = button_data["warna"]
kb23.angka = button_data["angka"]

button_image_22 = PhotoImage(
    file=relative_to_assets("button_22.png"))
kb31 = Button(
    image=button_image_22,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb31)
)
button_data = {"id": "kb31", "warna": "biru", "angka": 3}
# Store all data as attributes
kb31.id = button_data["id"]
kb31.warna = button_data["warna"]
kb31.angka = button_data["angka"]

kb32 = Button(
    image=button_image_22,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb32)
)
button_data = {"id": "kb32", "warna": "biru", "angka": 3}
# Store all data as attributes
kb32.id = button_data["id"]
kb32.warna = button_data["warna"]
kb32.angka = button_data["angka"]

kb33 = Button(
    image=button_image_22,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(kb33)
)
button_data = {"id": "kb33", "warna": "biru", "angka": 3}
# Store all data as attributes
kb33.id = button_data["id"]
kb33.warna = button_data["warna"]
kb33.angka = button_data["angka"]

# Button_24
button_image_24 = PhotoImage(
    file=relative_to_assets("button_24.png"))
km11 = Button(
    image=button_image_24,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km11)
)
button_data = {"id": "km11", "warna": "merah", "angka": 1}
# Store all data as attributes
km11.id = button_data["id"]
km11.warna = button_data["warna"]
km11.angka = button_data["angka"]

km12 = Button(
    image=button_image_24,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km12)
)
button_data = {"id": "km12", "warna": "merah", "angka": 1}
# Store all data as attributes
km12.id = button_data["id"]
km12.warna = button_data["warna"]
km12.angka = button_data["angka"]

km13 = Button(
    image=button_image_24,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km13)
)
button_data = {"id": "km13", "warna": "merah", "angka": 1}
# Store all data as attributes
km13.id = button_data["id"]
km13.warna = button_data["warna"]
km13.angka = button_data["angka"]

# Button_25
button_image_25 = PhotoImage(
    file=relative_to_assets("button_25.png"))
km21 = Button(
    image=button_image_25,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km21)
)
button_data = {"id": "km21", "warna": "merah", "angka": 2}
# Store all data as attributes
km21.id = button_data["id"]
km21.warna = button_data["warna"]
km21.angka = button_data["angka"]

km22 = Button(
    image=button_image_25,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km22)
)
button_data = {"id": "km22", "warna": "merah", "angka": 2}
# Store all data as attributes
km22.id = button_data["id"]
km22.warna = button_data["warna"]
km22.angka = button_data["angka"]

km23 = Button(
    image=button_image_25,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km23)
)
button_data = {"id": "km23", "warna": "merah", "angka": 2}
# Store all data as attributes
km23.id = button_data["id"]
km23.warna = button_data["warna"]
km23.angka = button_data["angka"]

# Button_26
button_image_26 = PhotoImage(
    file=relative_to_assets("button_26.png"))
km31 = Button(
    image=button_image_26,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km31)
)
button_data = {"id": "km31", "warna": "merah", "angka": 3}
# Store all data as attributes
km31.id = button_data["id"]
km31.warna = button_data["warna"]
km31.angka = button_data["angka"]

km32 = Button(
    image=button_image_26,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km32)
)
button_data = {"id": "km32", "warna": "merah", "angka": 3}
# Store all data as attributes
km32.id = button_data["id"]
km32.warna = button_data["warna"]
km32.angka = button_data["angka"]

km33 = Button(
    image=button_image_26,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(km33)
)
button_data = {"id": "km33", "warna": "merah", "angka": 3}
# Store all data as attributes
km33.id = button_data["id"]
km33.warna = button_data["warna"]
km33.angka = button_data["angka"]

############################# TITLE #################################
image_image_19 = PhotoImage(
    file=relative_to_assets("image_19.png"))
title_game = canvas.create_image(
    1054.0,
    395.0,
    image=image_image_19,
    tags=("title_game")
)

title_start = canvas.create_image(
    736.0,
    324.0,
    image=image_image_19,
    tags=("title_start")
)

############################# PLAYER AREA #################################
image_image_29 = PhotoImage(
    file=relative_to_assets("image_29.png"))
my_area = canvas.create_image(
    1323.0,
    115.0,
    image=image_image_29,
    tags=("tile", "pink_tile")
)
canvas.itemconfig(my_area, state='hidden')

image_image_30 = PhotoImage(
    file=relative_to_assets("image_30.png"))
his_area = canvas.create_image(
    1323.0,
    309.0,
    image=image_image_30,
    tags=("tile", "blue_tile")
)
canvas.itemconfig(his_area, state='hidden')

image_image_31 = PhotoImage(
    file=relative_to_assets("image_31.png"))
default_area = canvas.create_image(
    1119.0,
    115.0,
    image=image_image_31,
    tags=("tile", "default_tile")
)
canvas.itemconfig(default_area, state='hidden')

############################# DEFAULT CUP BUTTON #################################

button_image_7 = PhotoImage(
    file=relative_to_assets("button_7.png"))
cup_1 = Button(
    image=button_image_7,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(cup_1)
)
cup_1.place(
    width=157.0,
    height=155.0
)
gp1 = canvas.create_window(387.0, 330.0, window=cup_1)
button_data = {"id": "p1", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_1.id = button_data["id"]
cup_1.status = button_data["status"]
cup_1.warna = button_data["warna"]

button_image_8 = PhotoImage(
    file=relative_to_assets("button_8.png"))
cup_2 = Button(
    image=button_image_8,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: handle_button_click(cup_2),
    relief="flat"
)
cup_2.place(
    width=157.0,
    height=155.0
)
gp2 = canvas.create_window(563.0, 330.0, window=cup_2)
button_data = {"id": "p2", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_2.id = button_data["id"]
cup_2.status = button_data["status"]
cup_2.warna = button_data["warna"]

button_image_9 = PhotoImage(
    file=relative_to_assets("button_9.png"))
cup_3 = Button(
    image=button_image_9,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: handle_button_click(cup_3),
    relief="flat"
)
cup_3.place(
    width=157.0,
    height=155.0
)
gp3 = canvas.create_window(738.0, 330.0, window=cup_3)
button_data = {"id": "p3", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_3.id = button_data["id"]
cup_3.status = button_data["status"]
cup_3.warna = button_data["warna"]

button_image_10 = PhotoImage(
    file=relative_to_assets("button_10.png"))
cup_4 = Button(
    image=button_image_10,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: handle_button_click(cup_4),
    relief="flat"
)
cup_4.place(
    width=157.0,
    height=155.0
)
gp4 = canvas.create_window(387.0, 507.0, window=cup_4)
button_data = {"id": "p4", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_4.id = button_data["id"]
cup_4.status = button_data["status"]
cup_4.warna = button_data["warna"]

button_image_11 = PhotoImage(
    file=relative_to_assets("button_11.png"))
cup_5 = Button(
    image=button_image_11,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: handle_button_click(cup_5),
    relief="flat"
)
cup_5.place(
    width=157.0,
    height=155.0
)
gp5 = canvas.create_window(563.0, 507.0, window=cup_5)
button_data = {"id": "p5", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_5.id = button_data["id"]
cup_5.status = button_data["status"]
cup_5.warna = button_data["warna"]

button_image_12 = PhotoImage(
    file=relative_to_assets("button_12.png"))
cup_6 = Button(
    image=button_image_12,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: handle_button_click(cup_6),
    relief="flat"
)
cup_6.place(
    width=157.0,
    height=155.0
)
gp6 = canvas.create_window(738.0, 507.0, window=cup_6)
button_data = {"id": "p6", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_6.id = button_data["id"]
cup_6.status = button_data["status"]
cup_6.warna = button_data["warna"]

button_image_13 = PhotoImage(
    file=relative_to_assets("button_13.png"))
cup_7 = Button(
    image=button_image_13,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: handle_button_click(cup_7),
    relief="flat"
)
cup_7.place(
    width=157.0,
    height=155.0
)
gp7 = canvas.create_window(387.0, 684.0, window=cup_7)
button_data = {"id": "p7", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_7.id = button_data["id"]
cup_7.status = button_data["status"]
cup_7.warna = button_data["warna"]

button_image_14 = PhotoImage(
    file=relative_to_assets("button_14.png"))
cup_8 = Button(
    image=button_image_14,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: handle_button_click(cup_8),
    relief="flat"
)
cup_8.place(
    width=157.0,
    height=155.0
)
gp8 = canvas.create_window(563.0, 684.0, window=cup_8)
button_data = {"id": "p8", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_8.id = button_data["id"]
cup_8.status = button_data["status"]
cup_8.warna = button_data["warna"]

button_image_6 = PhotoImage(
    file=relative_to_assets("button_6.png"))
cup_9 = Button(
    image=button_image_6,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: handle_button_click(cup_9),
    relief="flat"
)
cup_9.place(
    width=157.0,
    height=155.0
)
gp9 = canvas.create_window(738.0, 684.0, window=cup_9)
button_data = {"id": "p9", "status": "kosong", "warna": "putih"}
# Store all data as attributes
cup_9.id = button_data["id"]
cup_9.status = button_data["status"]
cup_9.warna = button_data["warna"]

####################### DEFAULT COLORED CUP BUTTON #############################
button_image_33 = PhotoImage(
    file=relative_to_assets("button_33.png"))
blue_glass_1 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_1)
)
blue_glass_1.place(
    width=157.0,
    height=155.0
)
gb1 = canvas.create_window(387.0, 330.0, window=blue_glass_1)
button_data = {"id": "p1", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_1.id = button_data["id"]
blue_glass_1.status = button_data["status"]
blue_glass_1.warna = button_data["warna"]

blue_glass_2 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_2)
)
blue_glass_2.place(
    width=157.0,
    height=155.0
)
gb2 = canvas.create_window(563.0, 330.0, window=blue_glass_2)
button_data = {"id": "p2", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_2.id = button_data["id"]
blue_glass_2.status = button_data["status"]
blue_glass_2.warna = button_data["warna"]

blue_glass_3 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_3)
)
blue_glass_3.place(
    width=157.0,
    height=155.0
)
gb3 = canvas.create_window(738.0, 330.0, window=blue_glass_3)
button_data = {"id": "p3", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_3.id = button_data["id"]
blue_glass_3.status = button_data["status"]
blue_glass_3.warna = button_data["warna"]

blue_glass_4 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_4)
)
blue_glass_4.place(
    width=157.0,
    height=155.0
)
gb4 = canvas.create_window(387.0, 507.0, window=blue_glass_4)
button_data = {"id": "p4", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_4.id = button_data["id"]
blue_glass_4.status = button_data["status"]
blue_glass_4.warna = button_data["warna"]

blue_glass_5 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_5)
)
blue_glass_5.place(
    width=157.0,
    height=155.0
)
gb5 = canvas.create_window(563.0, 507.0, window=blue_glass_5)
button_data = {"id": "p5", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_5.id = button_data["id"]
blue_glass_5.status = button_data["status"]
blue_glass_5.warna = button_data["warna"]

blue_glass_6 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_6)
)
blue_glass_6.place(
    width=157.0,
    height=155.0
)
gb6 = canvas.create_window(738.0, 507.0, window=blue_glass_6)
button_data = {"id": "p6", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_6.id = button_data["id"]
blue_glass_6.status = button_data["status"]
blue_glass_6.warna = button_data["warna"]

blue_glass_7 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_7)
)
blue_glass_7.place(
    width=157.0,
    height=155.0
)
gb7 = canvas.create_window(387.0, 684.0, window=blue_glass_7)
button_data = {"id": "p7", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_7.id = button_data["id"]
blue_glass_7.status = button_data["status"]
blue_glass_7.warna = button_data["warna"]

blue_glass_8 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_8)
)
blue_glass_8.place(
    width=157.0,
    height=155.0
)
gb8 = canvas.create_window(563.0, 684.0, window=blue_glass_8)
button_data = {"id": "p8", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_8.id = button_data["id"]
blue_glass_8.status = button_data["status"]
blue_glass_8.warna = button_data["warna"]

blue_glass_9 = Button(
    image=button_image_33,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(blue_glass_9)
)
blue_glass_9.place(
    width=157.0,
    height=155.0
)
gb9 = canvas.create_window(738.0, 684.0, window=blue_glass_9)
button_data = {"id": "p9", "status": "kosong", "warna": "biru"}
# Store all data as attributes
blue_glass_9.id = button_data["id"]
blue_glass_9.status = button_data["status"]
blue_glass_9.warna = button_data["warna"]

button_image_34 = PhotoImage(
    file=relative_to_assets("button_34.png"))
red_glass_1 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_1)
)
red_glass_1.place(
    width=157.0,
    height=155.0
)
gm1 = canvas.create_window(387.0, 330.0, window=red_glass_1)
# GM1
button_data = {"id": "p1", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_1.id = button_data["id"]
red_glass_1.status = button_data["status"]
red_glass_1.warna = button_data["warna"]

red_glass_2 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_2)
)
red_glass_2.place(
    width=157.0,
    height=155.0
)
gm2 = canvas.create_window(563.0, 330.0, window=red_glass_2)
# GM2
button_data = {"id": "p2", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_2.id = button_data["id"]
red_glass_2.status = button_data["status"]
red_glass_2.warna = button_data["warna"]

red_glass_3 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_3)
)
red_glass_3.place(
    width=157.0,
    height=155.0
)
gm3 = canvas.create_window(738.0, 330.0, window=red_glass_3)
# GM3
button_data = {"id": "p3", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_3.id = button_data["id"]
red_glass_3.status = button_data["status"]
red_glass_3.warna = button_data["warna"]

red_glass_4 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_4)
)
red_glass_4.place(
    width=157.0,
    height=155.0
)
gm4 = canvas.create_window(387.0, 507.0, window=red_glass_4)
# GM4
button_data = {"id": "p4", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_4.id = button_data["id"]
red_glass_4.status = button_data["status"]
red_glass_4.warna = button_data["warna"]

red_glass_5 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_5)
)
red_glass_5.place(
    width=157.0,
    height=155.0
)
gm5 = canvas.create_window(563.0, 507.0, window=red_glass_5)
# GM5
button_data = {"id": "p5", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_5.id = button_data["id"]
red_glass_5.status = button_data["status"]
red_glass_5.warna = button_data["warna"]

red_glass_6 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_6)
)
red_glass_6.place(
    width=157.0,
    height=155.0
)
gm6 = canvas.create_window(738.0, 507.0, window=red_glass_6)
# GM6
button_data = {"id": "p6", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_6.id = button_data["id"]
red_glass_6.status = button_data["status"]
red_glass_6.warna = button_data["warna"]

red_glass_7 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_7)
)
red_glass_7.place(
    width=157.0,
    height=155.0
)
gm7 = canvas.create_window(387.0, 684.0, window=red_glass_7)
# GM7
button_data = {"id": "p7", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_7.id = button_data["id"]
red_glass_7.status = button_data["status"]
red_glass_7.warna = button_data["warna"]

red_glass_8 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_8)
)
red_glass_8.place(
    width=157.0,
    height=155.0
)
gm8 = canvas.create_window(563.0, 684.0, window=red_glass_8)
# GM8
button_data = {"id": "p8", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_8.id = button_data["id"]
red_glass_8.status = button_data["status"]
red_glass_8.warna = button_data["warna"]

red_glass_9 = Button(
    image=button_image_34,
    borderwidth=0,
    highlightthickness=0,
    relief="flat",
    command=lambda: handle_button_click(red_glass_9)
)
red_glass_9.place(
    width=157.0,
    height=155.0
)
gm9 = canvas.create_window(738.0, 684.0, window=red_glass_9)
# GM9
button_data = {"id": "p9", "status": "kosong", "warna": "merah"}
# Store all data as attributes
red_glass_9.id = button_data["id"]
red_glass_9.status = button_data["status"]
red_glass_9.warna = button_data["warna"]

############################# CAT HEADS #################################

image_image_32 = PhotoImage(
    file=relative_to_assets("image_32.png"))
white_head = canvas.create_image(
    102.0,
    100.0,
    image=image_image_32,
    tags=("cat_head", "white_head")
)

image_image_33 = PhotoImage(
    file=relative_to_assets("image_33.png"))
blue_head = canvas.create_image(
    344.0,
    100.0,
    image=image_image_33,
    tags=("cat_head", "blue_head")
)

image_image_34 = PhotoImage(
    file=relative_to_assets("image_34.png"))
red_head = canvas.create_image(
    223.0,
    100.0,
    image=image_image_34,
    tags=("cat_head", "red_head")
)

############################################## BUTTONS #############################################

button_image_1 = PhotoImage(
    file=relative_to_assets("button_1.png"))
draw_button = Button(
    image=button_image_1,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: print("draw_button clicked"),
    relief="flat"
)
draw_button.place(
    x=476.0,
    y=324.0,
    width=569.0,
    height=169.0
)
draw_button_id = canvas.create_window(476, 324, window=draw_button)

button_image_2 = PhotoImage(
    file=relative_to_assets("button_2.png"))
lose_button = Button(
    image=button_image_2,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: print("lose_button clicked"),
    relief="flat"
)
lose_button.place(
    x=476.0,
    y=324.0,
    width=564.0,
    height=169.0
)
lose_button_id = canvas.create_window(476, 324, window=lose_button)

button_image_3 = PhotoImage(
    file=relative_to_assets("button_3.png"))
win_button = Button(
    image=button_image_3,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: print("win_button clicked"),
    relief="flat"
)
win_button.place(
    x=476.0,
    y=324.0,
    width=566.0,
    height=169.0
)
win_button_id = canvas.create_window(476, 324, window=win_button)

button_image_4 = PhotoImage(
    file=relative_to_assets("button_4.png"))
start_button = Button(
    image=button_image_4,
    borderwidth=0,
    highlightthickness=0,
    command=lambda: show_all_elements(),
    relief="flat"
)
start_button.place(
    x=736.0,
    y=574.0,
    width=570.0,
    height=169.0
)
# 736.0,
# 324.0,
start_button_id = canvas.create_window(736, 574, window=start_button)

################################################### FUNCTIONS ######################################
#################
### VARIABLES ###
#################
button_x_pos = 476.0
button_y_pos = 324.0

card_id = [
    {"id": "kp1", "warna": "putih", "angka": 1},
    {"id": "kp2", "warna": "putih", "angka": 2},
    {"id": "kp3", "warna": "putih", "angka": 3},
    {"id": "kb1", "warna": "biru", "angka": 1},
    {"id": "kb2", "warna": "biru", "angka": 2},
    {"id": "kb3", "warna": "biru", "angka": 3},
    {"id": "km1", "warna": "merah", "angka": 1},
    {"id": "km2", "warna": "merah", "angka": 2},
    {"id": "km3", "warna": "merah", "angka": 3}
]

cup_id = [
    {"id": "p1", "status": "kosong", "warna": "putih"},
    {"id": "p2", "status": "kosong", "warna": "putih"},
    {"id": "p3", "status": "kosong", "warna": "putih"},
    {"id": "p4", "status": "kosong", "warna": "putih"},
    {"id": "p5", "status": "kosong", "warna": "putih"},
    {"id": "p6", "status": "kosong", "warna": "putih"},
    {"id": "p7", "status": "kosong", "warna": "putih"},
    {"id": "p8", "status": "kosong", "warna": "putih"},
    {"id": "p9", "status": "kosong", "warna": "putih"}
]

colored_cup_id = [
    {"id": "p1", "status": "kosong", "warna": "biru"},
    {"id": "p2", "status": "kosong", "warna": "biru"},
    {"id": "p3", "status": "kosong", "warna": "biru"},
    {"id": "p4", "status": "kosong", "warna": "biru"},
    {"id": "p5", "status": "kosong", "warna": "biru"},
    {"id": "p6", "status": "kosong", "warna": "biru"},
    {"id": "p7", "status": "kosong", "warna": "biru"},
    {"id": "p8", "status": "kosong", "warna": "biru"},
    {"id": "p9", "status": "kosong", "warna": "biru"},
    {"id": "p1", "status": "kosong", "warna": "merah"},
    {"id": "p2", "status": "kosong", "warna": "merah"},
    {"id": "p3", "status": "kosong", "warna": "merah"},
    {"id": "p4", "status": "kosong", "warna": "merah"},
    {"id": "p5", "status": "kosong", "warna": "merah"},
    {"id": "p6", "status": "kosong", "warna": "merah"},
    {"id": "p7", "status": "kosong", "warna": "merah"},
    {"id": "p8", "status": "kosong", "warna": "merah"},
    {"id": "p9", "status": "kosong", "warna": "merah"}
]


def hide_all_except_start():
    canvas.itemconfig("default_main_area", state='hidden')
    canvas.itemconfig("score_area", state='hidden')
    canvas.itemconfig("card_area", state='hidden')
    canvas.itemconfig("back_card", state='hidden')
    canvas.itemconfig("tile", state='hidden')
    canvas.itemconfig("cat_head", state='hidden')
    canvas.itemconfig("title_game", state='hidden')
    canvas.itemconfig(draw_button_id, state="hidden")
    canvas.itemconfig(win_button_id, state="hidden")
    canvas.itemconfig(lose_button_id, state="hidden")
    canvas.itemconfig(his_entry_score_id, state="hidden")
    canvas.itemconfig(her_entry_score_id, state="hidden")
    for i in range(1, 10):
        canvas.itemconfig(globals()[f"gp{i}"], state="hidden")
    for i in range(1, 10):
        canvas.itemconfig(globals()[f"gb{i}"], state="hidden")
    for i in range(1, 10):
        canvas.itemconfig(globals()[f"gm{i}"], state="hidden")
    # ... rest of the hiding logic


def show_all_elements():
    canvas.itemconfig("default_main_area", state='normal')
    canvas.itemconfig("score_area", state='normal')
    canvas.itemconfig("card_area", state='normal')
    canvas.itemconfig("back_card", state='normal')
    canvas.itemconfig("title_game", state='normal')
    canvas.itemconfig("title_start", state='hidden')
    canvas.itemconfig(his_entry_score_id, state="normal")
    canvas.itemconfig(her_entry_score_id, state="normal")
    canvas.itemconfig(start_button_id, state="hidden")
    for i in range(1, 10):
        canvas.itemconfig(globals()[f"gp{i}"], state="normal")
    select_and_show_random_buttons()
    place_random_buttons()

    # ... rest of the showing logic


def bagi_kartu(kartu):
    return random.sample(kartu, 3)


card_in_play = []


def remove_kartu(button):
    """Menghapus kartu berdasarkan ID"""
    global card_in_play
    card_positions = [
        (330.0, 762.0),  # Position 1
        (500.0, 762.0),  # Position 2
        (670.0, 762.0)  # Position 3
    ]
    print("ini card in play ", card_in_play)
    if button in card_in_play:
        print(f"card {button.id} not in play!")
        return

    pos_index = None
    for i, pos in enumerate(card_positions):
        if (button.winfo_x(), button.winfo_y()) == pos:
            pos_index = 1
            print("yag tereksekusi yg didalm if")
            break
        print("ini tereksekusi")
        print("ini nilai pos", pos)
    """pos_index=None
    for card in card_in_play:
        if card.id == button:
            button= card
            break
    if not pos_index:
        print(f"card {button} not found in play!")
        return

    posisi_card=(button.winfo_x(),button.winfo_y())
    pos_index=posisi_card.index(posisi_card)"""""

    button.place_forget()  # Hide the button
    print("setelah button hide", button)
    print("ini nilai pos setelah hiden", pos)
    # card_in_play.remove(button)
    print(f"Kartu dengan ID {button.id} berhasil dihapus.")
    ambil_kartu(pos)


def ambil_kartu(position_index):
    """Menambahkan kartu baru ke layar setelah first click"""
    global card_in_play
    all_buttons = [
        kp11, kp12, kp13, kp21, kp22, kp23, kp31, kp32, kp33,
        kb11, kb12, kb13, kb21, kb22, kb23, kb31, kb32, kb33,
        km11, km12, km13, km21, km22, km23, km31, km32, km33
    ]
    card_positions = [
        (330.0, 762.0),  # Position 1
        (500.0, 762.0),  # Position 2
        (670.0, 762.0)  # Position 3
    ]
    # available_card = [card for card in all_buttons if card not in card_in_play]
    # if available_card:
    new_card = random.choice(all_buttons)
    x, y = position_index
    new_card.place(x=x, y=y, anchor="nw")
    new_card.lift()
    # card_in_play.append(new_card)
    print(f"drew new card : {new_card.id} at position {position_index}")
    # else:
    # print("no more carad available to draw")


# Create containers for all buttons
red_buttons = {}
blue_buttons = {}
red_canvas_ids = {}
blue_canvas_ids = {}

# Store buttons and their canvas IDs when creating them
for i in range(1, 10):
    # For red buttons
    red_buttons[i] = globals()[f"red_glass_{i}"]
    red_canvas_ids[i] = globals()[f"gm{i}"]
    red_buttons[i]._canvas_id = red_canvas_ids[i]

    # For blue buttons
    blue_buttons[i] = globals()[f"blue_glass_{i}"]
    blue_canvas_ids[i] = globals()[f"gb{i}"]
    blue_buttons[i]._canvas_id = blue_canvas_ids[i]


def select_and_show_random_buttons():
    # Combine all buttons
    all_buttons = list(red_buttons.values()) + list(blue_buttons.values())

    # Group buttons by ID (both colors together)
    buttons_by_id = {}
    for button in all_buttons:
        if not hasattr(button, 'id'):
            continue

        if button.id not in buttons_by_id:
            buttons_by_id[button.id] = []
        buttons_by_id[button.id].append(button)

    # Select 3 unique random ids
    selected_ids = random.sample(list(buttons_by_id.keys()), min(3, len(buttons_by_id)))

    # Hide all buttons first
    for button in all_buttons:
        if hasattr(button, '_canvas_id'):
            canvas.itemconfig(button._canvas_id, state='hidden')

    # For each selected ID, randomly choose either red or blue to show
    for selected_id in selected_ids:
        available_buttons = buttons_by_id[selected_id]
        if available_buttons:  # Ensure there are buttons to choose from
            chosen_button = random.choice(available_buttons)
            canvas.itemconfig(chosen_button._canvas_id, state='normal')


def place_random_buttons():
    # List of all possible buttons
    global all_buttons, positions, card_in_play
    all_buttons = [
        kp11, kp12, kp13, kp21, kp22, kp23, kp31, kp32, kp33,
        kb11, kb12, kb13, kb21, kb22, kb23, kb31, kb32, kb33,
        km11, km12, km13, km21, km22, km23, km31, km32, km33
    ]

    # positions = [
    #     (310.0, 762.0),
    #     (480.0, 762.0),
    #     (650.0, 762.0)
    # ]
    positions = [
        (330.0, 762.0),
        (500.0, 762.0),
        (670.0, 762.0)
    ]

    # First hide all buttons
    for btn in all_buttons:
        btn.place_forget()  # Remove from placement manager

    # Select 3 unique buttons
    selected_buttons = random.sample(all_buttons, min(3, len(all_buttons)))

    # Place selected buttons
    for i, button in enumerate(selected_buttons):
        x, y = positions[i]
        button.place(
            x=x,
            y=y,
            # width=155.0,  # Make sure to include dimensions
            # height=153.0,
            anchor="nw"  # Explicit anchor point
        )
        button.lift()  # Bring to front
        print(f"Placed {button.id} at ({x}, {y})")

    # Force UI update
    button.master.update()


# Global variables to track button clicks
first_click = None
second_click = None
result = None


def handle_button_click(button):
    """Handles button clicks and compares two buttons"""
    global first_click, second_click, result, total_score

    # Get button attributes
    if hasattr(button, 'angka'):
        clicked_data = {
            "id": button.id,
            "warna": button.warna,
            "angka": button.angka,
        }
    else:
        clicked_data = {
            "id": button.id,
            "warna": button.warna,
            "status": button.status,
        }

    print(f"Button saved: {clicked_data}")

    # Store clicks
    if first_click is None:
        first_click = clicked_data
        print("First button selected. Click another button to compare.")
        if 'angka' in clicked_data:
            remove_kartu(button)
    else:
        second_click = clicked_data
        compare_buttons()
        if 'angka' in clicked_data:
            remove_kartu(button)
        update_my_score_display()
        # Reset for next comparison
        first_click = None
        second_click = None

    # Visual feedback
    button.config(relief="sunken")
    button.after(200, lambda: button.config(relief="flat"))


# At the top of your script (global scope)
comparison_results = []  # Stores all results
latest_result = None  # Stores the most recent result
total_score = 0  # Stores running total score


def compare_buttons():
    global total_score, comparison_results
    global first_click, second_click, result

    total_score = 0

    angka_button = first_click if 'angka' in first_click else second_click
    other_button = second_click if angka_button == first_click else first_click

    if first_click['warna'] == 'putih' or second_click['warna'] == 'putih':
        result = angka_button['angka']
        print(f"Result (white rule): {result}")
    elif first_click['warna'] == second_click['warna']:
        result = angka_button['angka'] * 2
        print(f"Result (color match): {result}")
    else:
        result = None
        print("No matching rule applies")

    latest_result = result
    comparison_results.append(result)

    for result in comparison_results:
        if result is not None:
            total_score += result

    print(f"Current total score: {total_score}")

    # # Tambahkan ini supaya Entry "Me:" update otomatis
    # update_my_score_display()

    return total_score


################################################### ALUR ###########################################
hide_all_except_start()
start_button = Button(command=lambda: show_all_elements())

canvas.move("all", 0, -50)
root.resizable(True, True)
root.mainloop()